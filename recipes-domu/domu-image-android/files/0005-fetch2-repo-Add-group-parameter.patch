From 971b79943ca5a162de2e52fd85e970c8b860c778 Mon Sep 17 00:00:00 2001
From: Ruslan Shymkevych <ruslan_shymkevych@epam.com>
Date: Wed, 26 Feb 2020 16:36:49 +0200
Subject: [PATCH 5/5] fetch2/repo: Add group parameter

Signed-off-by: Andrii Chepurnyi <andrii_chepurnyi@epam.com>
Signed-off-by: Ruslan Shymkevych <ruslan_shymkevych@epam.com>
---
 bitbake/lib/bb/fetch2/repo.py | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/bitbake/lib/bb/fetch2/repo.py b/bitbake/lib/bb/fetch2/repo.py
index 94841a1c81..c293751ede 100644
--- a/bitbake/lib/bb/fetch2/repo.py
+++ b/bitbake/lib/bb/fetch2/repo.py
@@ -80,7 +80,11 @@ class Repo(FetchMethod):
 
         bb.utils.mkdirhier(ud.repodir)
         bb.fetch2.check_network_access(d, "%s init -m %s -b %s -u %s://%s%s%s" % (ud.basecmd, ud.manifest, ud.branch, ud.proto, username, ud.host, ud.path), ud.url)
-        runfetchcmd("%s init -m %s -b %s -u %s://%s%s%s" % (ud.basecmd, ud.manifest, ud.branch, ud.proto, username, ud.host, ud.path), d, workdir=ud.repodir)
+        prebuilds = d.getVar("DDK_UM_PREBUILDS") or ""
+        if prebuilds:
+            runfetchcmd("%s init -m %s -b %s -u %s://%s%s%s" % (ud.basecmd, ud.manifest, ud.branch, ud.proto, username, ud.host, ud.path), d, workdir=ud.repodir)
+        else:
+            runfetchcmd("%s init -m %s -b %s -u %s://%s%s%s -g %s" % (ud.basecmd, ud.manifest, ud.branch, ud.proto, username, ud.host, ud.path, "all"), d, workdir=ud.repodir)
 
         bb.fetch2.check_network_access(d, "%s sync %s" % (ud.basecmd, ud.url), ud.url)
         self.sync(ud.repodir, d)
-- 
2.17.1

